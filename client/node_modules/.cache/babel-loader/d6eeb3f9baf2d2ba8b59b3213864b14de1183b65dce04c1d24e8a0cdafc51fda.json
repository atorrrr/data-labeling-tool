{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useParams,useNavigate,Link as RouterLink}from'react-router-dom';import axios from'axios';import{Container,Typography,Button,Box,Paper,LinearProgress}from'@mui/material';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function LabelingTool(){const[currentItem,setCurrentItem]=useState(null);const[label,setLabel]=useState('');const[progress,setProgress]=useState({total:0,labeled:0});const[labelOptions,setLabelOptions]=useState([]);const{datasetId}=useParams();const navigate=useNavigate();useEffect(()=>{fetchNextItem();fetchProgress();},[datasetId]);const fetchNextItem=async()=>{try{const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/items/next/\").concat(datasetId,\"/\").concat(currentItem?currentItem.id:0));if(res.data.msg==='No more items to label'){alert('Labeling session complete!');navigate('/');return;}setCurrentItem(res.data);setLabel(res.data.label||'');}catch(err){console.error('Error fetching item',err);alert('Error fetching next item');}};const fetchProgress=async()=>{try{const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/items/progress/\").concat(datasetId));setProgress(res.data);}catch(err){console.error('Error fetching progress',err);}};const submitLabel=async()=>{try{await axios.post(\"\".concat(process.env.REACT_APP_API_URL,\"/api/items/label\"),{itemId:currentItem.id,label});fetchNextItem();fetchProgress();}catch(err){console.error('Error submitting label',err);alert('Error saving label');}};const navigateItem=direction=>async()=>{if(!currentItem)return;try{const res=await axios.get(\"\".concat(process.env.REACT_APP_API_URL,\"/api/items/navigate/\").concat(datasetId,\"/\").concat(currentItem.id,\"/\").concat(direction));if(res.data.msg){alert(res.data.msg);return;}setCurrentItem(res.data);setLabel(res.data.label||'');}catch(err){console.error(\"Error navigating \".concat(direction),err);alert(\"Error navigating \".concat(direction));}};if(!currentItem){return/*#__PURE__*/_jsx(Typography,{children:\"Loading...\"});}return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,children:\"Labeling Tool\"}),/*#__PURE__*/_jsxs(Box,{sx:{width:'100%',mb:2},children:[/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:progress.labeled/progress.total*100}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[\"Progress: \",progress.labeled,\" / \",progress.total]})]}),/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:2,mb:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",component:\"pre\",sx:{whiteSpace:'pre-wrap',wordBreak:'break-word'},children:JSON.stringify(JSON.parse(currentItem.content),null,2)}),/*#__PURE__*/_jsx(Box,{sx:{mt:2},children:labelOptions.map(option=>/*#__PURE__*/_jsx(Button,{variant:label===option?\"contained\":\"outlined\",onClick:()=>setLabel(option),sx:{mr:1,mb:1},children:option},option))}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mt:2},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:navigateItem('prev'),children:\"Previous\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:submitLabel,children:\"Save and Next\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:navigateItem('next'),children:\"Next\"})]})]}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",component:RouterLink,to:\"/dataset/\".concat(datasetId,\"/import\"),children:\"Bulk Import\"})]});}export default LabelingTool;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","Link","RouterLink","axios","Container","Typography","Button","Box","Paper","LinearProgress","jsx","_jsx","jsxs","_jsxs","LabelingTool","currentItem","setCurrentItem","label","setLabel","progress","setProgress","total","labeled","labelOptions","setLabelOptions","datasetId","navigate","fetchNextItem","fetchProgress","res","get","concat","process","env","REACT_APP_API_URL","id","data","msg","alert","err","console","error","submitLabel","post","itemId","navigateItem","direction","children","maxWidth","variant","component","gutterBottom","sx","width","mb","value","color","elevation","p","whiteSpace","wordBreak","JSON","stringify","parse","content","mt","map","option","onClick","mr","display","justifyContent","to"],"sources":["/home/ec2-user/labeling-tool/client/src/pages/LabelingTool.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate, Link as RouterLink } from 'react-router-dom';\r\nimport axios from 'axios';\r\nimport { Container, Typography, Button, Box, Paper, LinearProgress } from '@mui/material';\r\n\r\nfunction LabelingTool() {\r\n  const [currentItem, setCurrentItem] = useState(null);\r\n  const [label, setLabel] = useState('');\r\n  const [progress, setProgress] = useState({ total: 0, labeled: 0 });\r\n  const [labelOptions, setLabelOptions] = useState([]);\r\n  const { datasetId } = useParams();\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    fetchNextItem();\r\n    fetchProgress();\r\n  }, [datasetId]);\r\n\r\n  const fetchNextItem = async () => {\r\n    try {\r\n      const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/items/next/${datasetId}/${currentItem ? currentItem.id : 0}`);\r\n      if (res.data.msg === 'No more items to label') {\r\n        alert('Labeling session complete!');\r\n        navigate('/');\r\n        return;\r\n      }\r\n      setCurrentItem(res.data);\r\n      setLabel(res.data.label || '');\r\n    } catch (err) {\r\n      console.error('Error fetching item', err);\r\n      alert('Error fetching next item');\r\n    }\r\n  };\r\n\r\n  const fetchProgress = async () => {\r\n    try {\r\n      const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/items/progress/${datasetId}`);\r\n      setProgress(res.data);\r\n    } catch (err) {\r\n      console.error('Error fetching progress', err);\r\n    }\r\n  };\r\n\r\n  const submitLabel = async () => {\r\n    try {\r\n      await axios.post(`${process.env.REACT_APP_API_URL}/api/items/label`, { itemId: currentItem.id, label });\r\n      fetchNextItem();\r\n      fetchProgress();\r\n    } catch (err) {\r\n      console.error('Error submitting label', err);\r\n      alert('Error saving label');\r\n    }\r\n  };\r\n\r\n  const navigateItem = (direction) => async () => {\r\n    if (!currentItem) return;\r\n    try {\r\n      const res = await axios.get(`${process.env.REACT_APP_API_URL}/api/items/navigate/${datasetId}/${currentItem.id}/${direction}`);\r\n      if (res.data.msg) {\r\n        alert(res.data.msg);\r\n        return;\r\n      }\r\n      setCurrentItem(res.data);\r\n      setLabel(res.data.label || '');\r\n    } catch (err) {\r\n      console.error(`Error navigating ${direction}`, err);\r\n      alert(`Error navigating ${direction}`);\r\n    }\r\n  };\r\n\r\n  if (!currentItem) {\r\n    return <Typography>Loading...</Typography>;\r\n  }\r\n\r\n  return (\r\n    <Container maxWidth=\"md\">\r\n      <Typography variant=\"h4\" component=\"h1\" gutterBottom>\r\n        Labeling Tool\r\n      </Typography>\r\n      <Box sx={{ width: '100%', mb: 2 }}>\r\n        <LinearProgress variant=\"determinate\" value={(progress.labeled / progress.total) * 100} />\r\n        <Typography variant=\"body2\" color=\"text.secondary\">\r\n          Progress: {progress.labeled} / {progress.total}\r\n        </Typography>\r\n      </Box>\r\n      <Paper elevation={3} sx={{ p: 2, mb: 2 }}>\r\n        <Typography variant=\"body1\" component=\"pre\" sx={{ whiteSpace: 'pre-wrap', wordBreak: 'break-word' }}>\r\n          {JSON.stringify(JSON.parse(currentItem.content), null, 2)}\r\n        </Typography>\r\n        <Box sx={{ mt: 2 }}>\r\n          {labelOptions.map((option) => (\r\n            <Button\r\n              key={option}\r\n              variant={label === option ? \"contained\" : \"outlined\"}\r\n              onClick={() => setLabel(option)}\r\n              sx={{ mr: 1, mb: 1 }}\r\n            >\r\n              {option}\r\n            </Button>\r\n          ))}\r\n        </Box>\r\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 2 }}>\r\n          <Button variant=\"outlined\" onClick={navigateItem('prev')}>\r\n            Previous\r\n          </Button>\r\n          <Button variant=\"contained\" onClick={submitLabel}>\r\n            Save and Next\r\n          </Button>\r\n          <Button variant=\"outlined\" onClick={navigateItem('next')}>\r\n            Next\r\n          </Button>\r\n        </Box>\r\n      </Paper>\r\n      <Button variant=\"outlined\" component={RouterLink} to={`/dataset/${datasetId}/import`}>\r\n        Bulk Import\r\n      </Button>\r\n    </Container>\r\n  );\r\n}\r\n\r\nexport default LabelingTool;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}